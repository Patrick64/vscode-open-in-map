<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"/>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <style>
        #mapid { height: 100vh; width: 100%; }
    </style>
</head>
<body>
    <div id="mapid"></div>
    <script>
        var mymap = L.map('mapid').setView([0, 0], 12);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(mymap);

        let markers = [];

        window.addEventListener('message', event => {
            const message = event.data; // The JSON data our extension sent
            switch (message.command) {
                case 'addMarker':
                    markers.push([message.lat, message.lng]);
                    L.marker([message.lat, message.lng]).addTo(mymap);
                    // mymap.setView([message.lat, message.lng], 13);
                    mymap.fitBounds(markers, { maxZoom: 12 });
                    break;
                case 'addMarkers':
                    console.log(message.markers);
                    markers = [...markers, ...message.markers];
                    message.markers.forEach(marker => {
                        L.marker(marker).addTo(mymap);    
                    });
                    // mymap.setView([message.lat, message.lng], 13);
                    mymap.fitBounds(markers, { maxZoom: 12 });
                    break;
            }
        });
    </script>
</body>
</html>